'use strict';const _0x1cc8f2=_0x3bae;(function(_0x4810d7,_0x3428b3){const _0x788951=_0x3bae,_0x98f34c=_0x4810d7();while(!![]){try{const _0x1994fb=-parseInt(_0x788951(0xd6))/0x1+parseInt(_0x788951(0xe0))/0x2+parseInt(_0x788951(0xe6))/0x3*(parseInt(_0x788951(0xe1))/0x4)+-parseInt(_0x788951(0xd5))/0x5*(parseInt(_0x788951(0xc3))/0x6)+-parseInt(_0x788951(0xdb))/0x7*(-parseInt(_0x788951(0xe3))/0x8)+-parseInt(_0x788951(0xba))/0x9+parseInt(_0x788951(0xc0))/0xa*(parseInt(_0x788951(0xf1))/0xb);if(_0x1994fb===_0x3428b3)break;else _0x98f34c['push'](_0x98f34c['shift']());}catch(_0x5e38df){_0x98f34c['push'](_0x98f34c['shift']());}}}(_0x4ccd,0x3416f));function _0x4ccd(){const _0x2d968a=['filter','tinkoff-invest-api/cjs/generated/instruments','5NIArPX','296702OjVSzq','tinkoff-invest-api/cjs/generated/marketdata','return','map','then','3745gwPfCp','pipe','toFixed','value','name','476690AJgGrA','12WEHrSG','tinkoff-invest-api','784HwAEYd','Subject','iterator','189129xqQGom','units','close','processOnCandle','buyTheDrop','startFuturesDrop','nano','SubscriptionInterval','buy','\x20мс','moexDiffFuture','54857zTsCMR','call','done','push','tap','rxjs','halt','function','haltTimeout','slice','next','getPrice','find','Время\x20запроса\x20futures:\x20','market','throw','stream','stop','figi','__asyncValues','DropFutures','unsubscribes','3485160nibsgb','instruments','createMarketStream','options','Время\x20обработки\x20свечи\x20для\x20','InstrumentStatus','1530yHwsde','nearestHighIncrementValue','perf_hooks','2073684aqtGMY','stream\x20error','now','asyncIterator','toNumber','api','performance','defineProperty','Symbol.asyncIterator\x20is\x20not\x20defined.','futures','../utils/nearest-increment-value','error','candles','stream\x20closed,\x20reason:','length','log'];_0x4ccd=function(){return _0x2d968a;};return _0x4ccd();}var __asyncValues=this&&this[_0x1cc8f2(0xb7)]||function(_0x338dd0){const _0x30e31f=_0x1cc8f2;if(!Symbol[_0x30e31f(0xc6)])throw new TypeError(_0x30e31f(0xcb));var _0x38113e=_0x338dd0[Symbol[_0x30e31f(0xc6)]],_0x49e493;return _0x38113e?_0x38113e[_0x30e31f(0xf2)](_0x338dd0):(_0x338dd0=typeof __values===_0x30e31f(0xab)?__values(_0x338dd0):_0x338dd0[Symbol[_0x30e31f(0xe5)]](),_0x49e493={},_0x5d7ff9(_0x30e31f(0xae)),_0x5d7ff9(_0x30e31f(0xb3)),_0x5d7ff9('return'),_0x49e493[Symbol[_0x30e31f(0xc6)]]=function(){return this;},_0x49e493);function _0x5d7ff9(_0x4732d4){_0x49e493[_0x4732d4]=_0x338dd0[_0x4732d4]&&function(_0x31df55){return new Promise(function(_0x1d0b72,_0x544b20){const _0x3ecf72=_0x3bae;_0x31df55=_0x338dd0[_0x4732d4](_0x31df55),_0x501175(_0x1d0b72,_0x544b20,_0x31df55[_0x3ecf72(0xf3)],_0x31df55[_0x3ecf72(0xde)]);});};}function _0x501175(_0x19a336,_0x460df5,_0x3f592b,_0x4fa2f3){Promise['resolve'](_0x4fa2f3)['then'](function(_0x1f5325){_0x19a336({'value':_0x1f5325,'done':_0x3f592b});},_0x460df5);}};Object[_0x1cc8f2(0xca)](exports,'__esModule',{'value':!![]}),exports[_0x1cc8f2(0xb8)]=void 0x0;function _0x3bae(_0x299da4,_0x11a912){const _0x4ccdc1=_0x4ccd();return _0x3bae=function(_0x3bae9e,_0x3f9f1a){_0x3bae9e=_0x3bae9e-0xa8;let _0x5771b1=_0x4ccdc1[_0x3bae9e];return _0x5771b1;},_0x3bae(_0x299da4,_0x11a912);}const rxjs_1=require(_0x1cc8f2(0xa9)),tinkoff_invest_api_1=require(_0x1cc8f2(0xe2)),instruments_1=require(_0x1cc8f2(0xd4)),marketdata_1=require(_0x1cc8f2(0xd7)),nearest_increment_value_1=require(_0x1cc8f2(0xcd)),perf_hooks_1=require(_0x1cc8f2(0xc2)),CHANK_SIZE=0x12c;class DropFutures{constructor(_0x527f9a,_0x32dfc2){const _0x2aa223=_0x1cc8f2;this[_0x2aa223(0xc8)]=_0x527f9a,this[_0x2aa223(0xbd)]=_0x32dfc2,this[_0x2aa223(0xea)]=new rxjs_1[(_0x2aa223(0xe4))](),this[_0x2aa223(0xb9)]=[],this[_0x2aa223(0xee)]=this[_0x2aa223(0xea)][_0x2aa223(0xdc)]((0x0,rxjs_1[_0x2aa223(0xd3)])(()=>!this[_0x2aa223(0xaa)]),(0x0,rxjs_1[_0x2aa223(0xa8)])(()=>{const _0x3ff14e=_0x2aa223;!this['halt']&&(this[_0x3ff14e(0xaa)]=!![],setTimeout(()=>this[_0x3ff14e(0xaa)]=![],this['options'][_0x3ff14e(0xac)]));}));}async[_0x1cc8f2(0xeb)](){const _0x2015ef=_0x1cc8f2;var _0x5c3335,_0x45a90b,_0x1b7476,_0x40e50f;const _0x55b412=perf_hooks_1[_0x2015ef(0xc9)]['now'](),_0x2e46cc=await this[_0x2015ef(0xc8)][_0x2015ef(0xbb)][_0x2015ef(0xcc)]({'instrumentStatus':instruments_1[_0x2015ef(0xbf)]['INSTRUMENT_STATUS_BASE']}),_0x463df5=perf_hooks_1[_0x2015ef(0xc9)][_0x2015ef(0xc5)]();console[_0x2015ef(0xd2)](_0x2015ef(0xb1)+(_0x463df5-_0x55b412)[_0x2015ef(0xdd)](0x2)+_0x2015ef(0xef));const _0x2525da=[];for(let _0x2d910e=0x0;_0x2d910e<_0x2e46cc['instruments'][_0x2015ef(0xd1)];_0x2d910e+=CHANK_SIZE){_0x2525da[_0x2015ef(0xf4)](_0x2e46cc[_0x2015ef(0xbb)][_0x2015ef(0xad)](_0x2d910e,_0x2d910e+CHANK_SIZE));}try{for(var _0x167454=!![],_0x288694=__asyncValues(_0x2525da),_0x362ea7;_0x362ea7=await _0x288694[_0x2015ef(0xae)](),_0x5c3335=_0x362ea7[_0x2015ef(0xf3)],!_0x5c3335;){_0x40e50f=_0x362ea7[_0x2015ef(0xde)],_0x167454=![];try{const _0x129f65=_0x40e50f,_0xc58fd4=await this['api'][_0x2015ef(0xbc)]()[_0x2015ef(0xcf)]({'instruments':_0x129f65[_0x2015ef(0xd9)](_0xb3f187=>({'figi':_0xb3f187[_0x2015ef(0xb6)],'interval':marketdata_1[_0x2015ef(0xed)]['SUBSCRIPTION_INTERVAL_ONE_MINUTE']})),'waitingClose':![]},_0x307ef6=>this[_0x2015ef(0xe9)](_0x307ef6,_0x129f65));this[_0x2015ef(0xb9)][_0x2015ef(0xf4)](_0xc58fd4),this['api'][_0x2015ef(0xb4)][_0x2015ef(0xb2)]['on'](_0x2015ef(0xce),_0x492bab=>console[_0x2015ef(0xd2)](_0x2015ef(0xc4),_0x492bab)),this[_0x2015ef(0xc8)][_0x2015ef(0xb4)][_0x2015ef(0xb2)]['on'](_0x2015ef(0xe8),_0x3cd7f1=>console[_0x2015ef(0xd2)](_0x2015ef(0xd0),_0x3cd7f1));}finally{_0x167454=!![];}}}catch(_0x189a59){_0x45a90b={'error':_0x189a59};}finally{try{if(!_0x167454&&!_0x5c3335&&(_0x1b7476=_0x288694[_0x2015ef(0xd8)]))await _0x1b7476[_0x2015ef(0xf2)](_0x288694);}finally{if(_0x45a90b)throw _0x45a90b['error'];}}return this[_0x2015ef(0xee)];}[_0x1cc8f2(0xe9)](_0x2f05ba,_0x4023f9){const _0x5eca25=_0x1cc8f2,{open:_0x107fc4,low:_0x31d780}=_0x2f05ba,_0x3ab253=_0x4023f9[_0x5eca25(0xb0)](_0x10c7aa=>_0x10c7aa[_0x5eca25(0xb6)]===_0x2f05ba[_0x5eca25(0xb6)]),_0x174687=Number(_0x31d780[_0x5eca25(0xe7)]+'.'+_0x31d780[_0x5eca25(0xec)]),_0x2bdb95=Number(_0x107fc4['units']+'.'+_0x107fc4[_0x5eca25(0xec)]);if(_0x2bdb95*this[_0x5eca25(0xbd)][_0x5eca25(0xf0)]>_0x174687){const _0x3c5689=perf_hooks_1[_0x5eca25(0xc9)][_0x5eca25(0xc5)]();this[_0x5eca25(0xea)]['next']({'price':this[_0x5eca25(0xaf)](_0x174687,_0x2bdb95-_0x174687,_0x3ab253),'future':_0x3ab253});const _0x298960=perf_hooks_1['performance']['now']();console[_0x5eca25(0xd2)](_0x5eca25(0xbe)+_0x3ab253[_0x5eca25(0xdf)]+':\x20'+(_0x298960-_0x3c5689)[_0x5eca25(0xdd)](0x2)+_0x5eca25(0xef));}}[_0x1cc8f2(0xaf)](_0x1abdc2,_0x3db159,_0x2de8bc){const _0x40ce24=_0x1cc8f2;return(0x0,nearest_increment_value_1[_0x40ce24(0xc1)])(_0x1abdc2+_0x3db159*this[_0x40ce24(0xbd)]['moexDiffFutureBuy'],tinkoff_invest_api_1['Helpers'][_0x40ce24(0xc7)](_0x2de8bc['minPriceIncrement']));}[_0x1cc8f2(0xb5)](){const _0x32b0af=_0x1cc8f2;Promise['all'](this[_0x32b0af(0xb9)])[_0x32b0af(0xda)]();}}exports[_0x1cc8f2(0xb8)]=DropFutures;