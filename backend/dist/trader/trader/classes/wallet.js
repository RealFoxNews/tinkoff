'use strict';const _0x240397=_0x48bd;(function(_0x165c4c,_0x543d9f){const _0x50cb5c=_0x48bd,_0x507de9=_0x165c4c();while(!![]){try{const _0xb54e6c=parseInt(_0x50cb5c(0x134))/0x1+-parseInt(_0x50cb5c(0x12d))/0x2*(parseInt(_0x50cb5c(0x12b))/0x3)+parseInt(_0x50cb5c(0x11b))/0x4*(-parseInt(_0x50cb5c(0x14b))/0x5)+-parseInt(_0x50cb5c(0x11d))/0x6+-parseInt(_0x50cb5c(0x140))/0x7*(-parseInt(_0x50cb5c(0x151))/0x8)+parseInt(_0x50cb5c(0x145))/0x9*(-parseInt(_0x50cb5c(0x122))/0xa)+parseInt(_0x50cb5c(0x150))/0xb*(parseInt(_0x50cb5c(0x13f))/0xc);if(_0xb54e6c===_0x543d9f)break;else _0x507de9['push'](_0x507de9['shift']());}catch(_0x21835f){_0x507de9['push'](_0x507de9['shift']());}}}(_0x55e1,0x42420));Object[_0x240397(0x148)](exports,'__esModule',{'value':!![]}),exports[_0x240397(0x113)]=void 0x0;const tinkoff_invest_api_1=require('tinkoff-invest-api'),orders_1=require(_0x240397(0x12e)),uuid_1=require(_0x240397(0x149)),messenger_1=require('./messenger'),perf_hooks_1=require(_0x240397(0x11e));class Wallet{constructor(_0x22c6c6,_0x3b8e41,_0x23cf0d){const _0x82ba00=_0x240397;this[_0x82ba00(0x127)]=_0x22c6c6,this['accountId']=_0x3b8e41,this[_0x82ba00(0x147)]=_0x23cf0d,this[_0x82ba00(0x136)]=new messenger_1[(_0x82ba00(0x130))](),this[_0x82ba00(0x123)]=new Set();}async[_0x240397(0x120)](){const _0x3a1057=_0x240397,_0x7c42cb=perf_hooks_1[_0x3a1057(0x139)]['now']();this[_0x3a1057(0x133)]=new tinkoff_invest_api_1[(_0x3a1057(0x124))](this[_0x3a1057(0x127)],this['accountId']),console[_0x3a1057(0x135)](_0x3a1057(0x125));const _0xd75fe9=perf_hooks_1[_0x3a1057(0x139)][_0x3a1057(0x13a)]();console['log'](_0x3a1057(0x11c)+(_0xd75fe9-_0x7c42cb)['toFixed'](0x2)+'\x20мс');}[_0x240397(0x131)](){const _0x3b23cb=_0x240397;this[_0x3b23cb(0x116)]=undefined,this[_0x3b23cb(0x133)]=undefined,this[_0x3b23cb(0x123)][_0x3b23cb(0x11a)](_0x37cbc0=>this['cancelOrder'](_0x37cbc0,'Выключение','Все',0x0)),console[_0x3b23cb(0x135)]('Кошелек\x20выключен');}[_0x240397(0x132)](_0x264a36,_0x49fe87,_0x4a062f,_0x395be8){const _0x4cab3e=_0x240397;if(!this[_0x4cab3e(0x133)])return;const _0x2b0436=_0x395be8?_0x395be8:_0x49fe87[_0x4cab3e(0x141)][_0x4cab3e(0x14e)](_0x4cab3e(0x112))?this[_0x4cab3e(0x147)][_0x4cab3e(0x11f)][_0x4cab3e(0x111)]:this['options']['drop'][_0x4cab3e(0x14d)],_0x191cbf=Math['floor'](Math[_0x4cab3e(0x121)](_0x2b0436/(_0x264a36*_0x49fe87['lot']))),_0x381bc3=!_0x191cbf?0x1:_0x191cbf,_0x1617a8=_0x49fe87[_0x4cab3e(0x12a)]+':\x20'+_0x381bc3+_0x4cab3e(0x114)+_0x264a36;this[_0x4cab3e(0x136)][_0x4cab3e(0x129)](_0x4a062f,_0x1617a8);const _0x526c03=perf_hooks_1['performance']['now']();this[_0x4cab3e(0x133)][_0x4cab3e(0x115)]({'figi':_0x49fe87[_0x4cab3e(0x128)],'quantity':_0x381bc3,'price':this[_0x4cab3e(0x127)][_0x4cab3e(0x118)][_0x4cab3e(0x13d)](_0x264a36),'direction':orders_1[_0x4cab3e(0x119)][_0x4cab3e(0x14a)],'orderType':orders_1[_0x4cab3e(0x14f)]['ORDER_TYPE_LIMIT'],'orderId':(0x0,uuid_1['v4'])()})['then'](_0x4ce5ea=>{const _0x1d47c2=_0x4cab3e,_0x5de627=perf_hooks_1[_0x1d47c2(0x139)][_0x1d47c2(0x13a)]();console['log']('Время\x20выполнения\x20postOrder:\x20'+(_0x5de627-_0x526c03)['toFixed'](0x2)+_0x1d47c2(0x14c)),this[_0x1d47c2(0x136)][_0x1d47c2(0x142)](_0x4a062f,_0x1617a8,_0x1d47c2(0x143),_0x49fe87['ticker']),_0x4ce5ea&&_0x4ce5ea[_0x1d47c2(0x144)]&&this[_0x1d47c2(0x123)]['add'](_0x4ce5ea[_0x1d47c2(0x144)]),this[_0x1d47c2(0x13c)](_0x4ce5ea&&_0x4ce5ea[_0x1d47c2(0x144)],_0x4a062f,_0x49fe87['ticker'],0x3d*0x3e8);})['catch'](_0x843c8b=>{const _0x4b4598=_0x4cab3e;var _0x5a3e59;const _0x2005b6=perf_hooks_1[_0x4b4598(0x139)][_0x4b4598(0x13a)]();console[_0x4b4598(0x135)](_0x4b4598(0x126)+(_0x2005b6-_0x526c03)['toFixed'](0x2)+_0x4b4598(0x14c)),this[_0x4b4598(0x136)]['openLimitOrderLogMessage'](_0x4a062f,_0x1617a8,'error',_0x49fe87[_0x4b4598(0x12a)],(_0x5a3e59=_0x843c8b===null||_0x843c8b===void 0x0?void 0x0:_0x843c8b[_0x4b4598(0x12c)])===null||_0x5a3e59===void 0x0?void 0x0:_0x5a3e59[_0x4b4598(0x136)]);});}['cancelOrder'](_0x29cff2,_0x1f58c7,_0x2a62f6,_0x50907c){if(_0x29cff2)setTimeout(()=>{const _0xd0469b=_0x48bd;if(this[_0xd0469b(0x133)]){const _0x3df791=perf_hooks_1['performance'][_0xd0469b(0x13a)]();this['account'][_0xd0469b(0x13c)](_0x29cff2)[_0xd0469b(0x13e)](_0xa190d=>{const _0x2a94b9=_0xd0469b,_0x484dd9=perf_hooks_1[_0x2a94b9(0x139)][_0x2a94b9(0x13a)]();console[_0x2a94b9(0x135)](_0x2a94b9(0x146)+(_0x484dd9-_0x3df791)[_0x2a94b9(0x138)](0x2)+_0x2a94b9(0x14c)),this[_0x2a94b9(0x136)][_0x2a94b9(0x12f)](_0x1f58c7,_0x2a94b9(0x143),_0x2a62f6),this['activeOrders']['delete'](_0x29cff2);})[_0xd0469b(0x117)](_0x2fd6d4=>{const _0x445cb8=_0xd0469b;var _0x4bb4fc;const _0xfabdc4=perf_hooks_1[_0x445cb8(0x139)][_0x445cb8(0x13a)]();console[_0x445cb8(0x135)](_0x445cb8(0x137)+(_0xfabdc4-_0x3df791)[_0x445cb8(0x138)](0x2)+_0x445cb8(0x14c)),this['message']['cancelLimitOrderLogMessage'](_0x1f58c7,_0x445cb8(0x13b),_0x2a62f6,(_0x4bb4fc=_0x2fd6d4===null||_0x2fd6d4===void 0x0?void 0x0:_0x2fd6d4['payload'])===null||_0x4bb4fc===void 0x0?void 0x0:_0x4bb4fc['message']);});}},_0x50907c);}}exports['Wallet']=Wallet;function _0x48bd(_0x4abbbe,_0x8bdc85){const _0x55e194=_0x55e1();return _0x48bd=function(_0x48bdf7,_0x2a8414){_0x48bdf7=_0x48bdf7-0x111;let _0xdff4eb=_0x55e194[_0x48bdf7];return _0xdff4eb;},_0x48bd(_0x4abbbe,_0x8bdc85);}function _0x55e1(){const _0x5e5c1c=['drop','init','floor','2525090OiEiZN','activeOrders','RealAccount','Кошелек\x20запущен','Время\x20выполнения\x20postOrder\x20(с\x20ошибкой):\x20','api','figi','byLogMessage','ticker','90942TftplP','payload','22IikYte','tinkoff-invest-api/cjs/generated/orders','cancelLimitOrderLogMessage','Messenger','stop','buy','account','456639aLYFIQ','log','message','Время\x20выполнения\x20cancelOrder\x20(с\x20ошибкой):\x20','toFixed','performance','now','error','cancelOrder','toQuotation','then','2037132FVeWbg','500059KKMKQm','exchange','openLimitOrderLogMessage','success','orderId','9wIPOzE','Время\x20выполнения\x20cancelOrder:\x20','options','defineProperty','uuid','ORDER_DIRECTION_BUY','5mKbopl','\x20мс','foreignMaxMoneySize','includes','OrderType','44SEZFgc','40wriRKJ','maxMOEXMoneySize','FORTS_EVENING','Wallet','\x20по\x20','postOrder','portfolio','catch','helpers','OrderDirection','forEach','1951212vBOHeG','Время\x20инициализации\x20аккаунта:\x20','886260ZNjsFA','perf_hooks'];_0x55e1=function(){return _0x5e5c1c;};return _0x55e1();}