'use strict';const _0x7da7e1=_0x38df;function _0x515f(){const _0x1183db=['997435gRIvOl','Subject','sub','</strong>\x0a<strong>$','529900hBMFzj','add','http://www.nasdaqtrader.com/rss.aspx?feed=tradehalts','1528386cnPxrf','subscribe','stop','BehaviorSubject','206860BerDdG','../classes/share.watcher.class','ndaq:ReasonCode','\x1b[37m','init','ndaq:IssueSymbol','T11','nasdaqHalts','toString','post','ShareWather','processesStratagy','watch','channel','next','Injectable','shares','6cvZoxd','haltsSet','7HDECOU','</strong>\x0a<strong>Код\x20остановки:\x20','\x1b[31m','includes','unsubscribe','from','CronJob','https://www.tinkoff.ru/invest/stocks/','settings','join','log','__metadata','ticker','T10','decorate','complete','340888nFzSyi','cron','563232kDegXX','botId','T12','timeInterval','data','html','getHalts','parse','pipe','text/xml','object','length','defineProperty','Сервис\x20торговых\x20пауз\x20запущен','application/xml','rss','function','XMLParser','fast-xml-parser','__esModule','144wsXGkp','default','rxjs','design:paramtypes','isArray','T13','item','startWith','\x1b[36m%s\x1b[0m','chatId','metadata','interval','then','find','\x20-\x20Перейти\x20в\x20Тинькофф','242234bSJqiR','start','ShareHalts','LUDP','https://api.telegram.org/bot'];_0x515f=function(){return _0x1183db;};return _0x515f();}(function(_0x546602,_0x33e5d4){const _0x28a460=_0x38df,_0x109d88=_0x546602();while(!![]){try{const _0xfc44f6=parseInt(_0x28a460(0x23b))/0x1+-parseInt(_0x28a460(0x216))/0x2+-parseInt(_0x28a460(0x204))/0x3*(-parseInt(_0x28a460(0x244))/0x4)+-parseInt(_0x28a460(0x240))/0x5+parseInt(_0x28a460(0x247))/0x6*(-parseInt(_0x28a460(0x206))/0x7)+-parseInt(_0x28a460(0x218))/0x8+parseInt(_0x28a460(0x22c))/0x9*(parseInt(_0x28a460(0x1f3))/0xa);if(_0xfc44f6===_0x33e5d4)break;else _0x109d88['push'](_0x109d88['shift']());}catch(_0x21347a){_0x109d88['push'](_0x109d88['shift']());}}}(_0x515f,0x22ef6));var __decorate=this&&this['__decorate']||function(_0x2b62b2,_0x5a301d,_0x3e91de,_0x30612e){const _0x400523=_0x38df;var _0x1f4014=arguments[_0x400523(0x223)],_0x56687f=_0x1f4014<0x3?_0x5a301d:_0x30612e===null?_0x30612e=Object['getOwnPropertyDescriptor'](_0x5a301d,_0x3e91de):_0x30612e,_0x1f085b;if(typeof Reflect===_0x400523(0x222)&&typeof Reflect[_0x400523(0x214)]===_0x400523(0x228))_0x56687f=Reflect[_0x400523(0x214)](_0x2b62b2,_0x5a301d,_0x3e91de,_0x30612e);else{for(var _0x5f0311=_0x2b62b2[_0x400523(0x223)]-0x1;_0x5f0311>=0x0;_0x5f0311--)if(_0x1f085b=_0x2b62b2[_0x5f0311])_0x56687f=(_0x1f4014<0x3?_0x1f085b(_0x56687f):_0x1f4014>0x3?_0x1f085b(_0x5a301d,_0x3e91de,_0x56687f):_0x1f085b(_0x5a301d,_0x3e91de))||_0x56687f;}return _0x1f4014>0x3&&_0x56687f&&Object[_0x400523(0x224)](_0x5a301d,_0x3e91de,_0x56687f),_0x56687f;},__metadata=this&&this[_0x7da7e1(0x211)]||function(_0x3b1507,_0x2e9536){const _0xbc93a3=_0x7da7e1;if(typeof Reflect===_0xbc93a3(0x222)&&typeof Reflect[_0xbc93a3(0x236)]===_0xbc93a3(0x228))return Reflect['metadata'](_0x3b1507,_0x2e9536);};Object['defineProperty'](exports,_0x7da7e1(0x22b),{'value':!![]}),exports[_0x7da7e1(0x23d)]=void 0x0;const common_1=require('@nestjs/common'),axios_1=require('axios'),cron_1=require(_0x7da7e1(0x217)),fast_xml_parser_1=require(_0x7da7e1(0x22a)),fs=require('fs'),path=require('path'),rxjs_1=require(_0x7da7e1(0x22e)),share_watcher_class_1=require(_0x7da7e1(0x1f4));function _0x38df(_0x68015d,_0x2a6371){const _0x515f07=_0x515f();return _0x38df=function(_0x38dfd6,_0x4dfa4e){_0x38dfd6=_0x38dfd6-0x1f1;let _0x52a05a=_0x515f07[_0x38dfd6];return _0x52a05a;},_0x38df(_0x68015d,_0x2a6371);}let ShareHalts=class ShareHalts extends share_watcher_class_1[_0x7da7e1(0x1fd)]{constructor(){const _0x1b202d=_0x7da7e1;super(),this['nasdaqHalts']=new rxjs_1[(_0x1b202d(0x241))](),this[_0x1b202d(0x205)]=new Set(),this['init']=!![],this['sendMessageOnHalts']=(_0x425892,_0x2bba17,_0x566bcb)=>{const _0x20e515=_0x1b202d,_0x2fb621='<strong>Остановка\x20торгов\x20'+_0x425892+_0x20e515(0x207)+_0x2bba17+_0x20e515(0x243)+_0x566bcb+'</strong>\x20\x0a',_0x3883b2=_0x566bcb?{'inline_keyboard':[[{'text':_0x566bcb+_0x20e515(0x23a),'url':_0x20e515(0x20d)+_0x566bcb}]]}:{};axios_1[_0x20e515(0x22d)]['post'](_0x20e515(0x23f)+this['botId']+'/sendMessage',{'text':_0x2fb621},{'params':{'chat_id':this['chatId'],'parse_mode':_0x20e515(0x21d),'reply_markup':_0x3883b2}})[_0x20e515(0x238)]()['catch'](_0x6138e4=>console[_0x20e515(0x210)](_0x6138e4));};const _0xa10967=JSON[_0x1b202d(0x21f)](fs['readFileSync'](path[_0x1b202d(0x20f)](__dirname,'..','..','..','..','config.json'))[_0x1b202d(0x1fb)]());this['botId']=_0xa10967[_0x1b202d(0x20e)][_0x1b202d(0x219)],this[_0x1b202d(0x235)]=_0xa10967[_0x1b202d(0x20e)][_0x1b202d(0x235)];}[_0x7da7e1(0x1ff)](_0x4719e1){const _0x26b672=_0x7da7e1;return this[_0x26b672(0x203)]=_0x4719e1,this[_0x26b672(0x237)]=(0x0,rxjs_1['interval'])(0xea60)[_0x26b672(0x220)]((0x0,rxjs_1[_0x26b672(0x233)])(null),(0x0,rxjs_1[_0x26b672(0x21b)])(),(0x0,rxjs_1['mergeMap'])(()=>this[_0x26b672(0x21e)]()))[_0x26b672(0x248)](_0x4c5217=>{const _0x42cacf=_0x26b672;this[_0x42cacf(0x1fe)](_0x4c5217);if(this[_0x42cacf(0x1f7)])this[_0x42cacf(0x1f7)]=![];}),this['cron']=new cron_1[(_0x26b672(0x20c))]('00\x2000\x2003\x20*\x20*\x200-6',()=>this[_0x26b672(0x205)]=new Set()),this['cron'][_0x26b672(0x23c)](),console['log'](_0x26b672(0x234),_0x26b672(0x225),_0x26b672(0x1f6)),this[_0x26b672(0x242)]=new rxjs_1[(_0x26b672(0x1f2))](null),this[_0x26b672(0x1fa)][_0x26b672(0x248)](_0x2f58c9=>this[_0x26b672(0x242)][_0x26b672(0x201)](this[_0x26b672(0x205)])),this[_0x26b672(0x242)];}['unWatch'](){const _0x116107=_0x7da7e1;this[_0x116107(0x217)]&&this[_0x116107(0x217)][_0x116107(0x1f1)](),this[_0x116107(0x242)]&&this[_0x116107(0x242)][_0x116107(0x215)](),this['interval']&&this[_0x116107(0x237)][_0x116107(0x20a)](),console['log'](_0x116107(0x208),'Сервис\x20торговых\x20пауз\x20выключен',_0x116107(0x1f6));}[_0x7da7e1(0x21e)](){const _0x4f9025=_0x7da7e1;return(0x0,rxjs_1[_0x4f9025(0x20b)])(axios_1[_0x4f9025(0x22d)][_0x4f9025(0x1fc)](_0x4f9025(0x246),null,{'headers':{'Accept':_0x4f9025(0x226),'Content-Type':_0x4f9025(0x221)}}))[_0x4f9025(0x220)]((0x0,rxjs_1['map'])(_0x5232b0=>new fast_xml_parser_1[(_0x4f9025(0x229))]()['parse'](_0x5232b0&&_0x5232b0[_0x4f9025(0x21c)])));}[_0x7da7e1(0x1fe)](_0x3cd942){const _0x2927d5=_0x7da7e1;var _0x391e6a,_0x4535e6;(_0x4535e6=(_0x391e6a=_0x3cd942===null||_0x3cd942===void 0x0?void 0x0:_0x3cd942[_0x2927d5(0x227)])===null||_0x391e6a===void 0x0?void 0x0:_0x391e6a[_0x2927d5(0x200)])===null||_0x4535e6===void 0x0?void 0x0:_0x4535e6[_0x2927d5(0x232)]['map'](_0x1e492f=>{const _0x5ab85f=_0x2927d5,_0x4d7802=_0x1e492f[_0x5ab85f(0x1f8)],_0x57bc6e=_0x1e492f['ndaq:ReasonCode'];_0x4d7802&&(_0x57bc6e['includes']('T1')||_0x57bc6e[_0x5ab85f(0x209)]('M')||_0x57bc6e[_0x5ab85f(0x209)](_0x5ab85f(0x23e)))&&!_0x57bc6e[_0x5ab85f(0x209)](_0x5ab85f(0x213))&&!_0x57bc6e['includes'](_0x5ab85f(0x1f9))&&!_0x57bc6e[_0x5ab85f(0x209)](_0x5ab85f(0x21a))&&!_0x57bc6e['includes'](_0x5ab85f(0x231))&&!this[_0x5ab85f(0x205)]['has'](_0x4d7802)&&(Array[_0x5ab85f(0x230)](this['shares'])&&this[_0x5ab85f(0x203)][_0x5ab85f(0x239)](_0x44868=>_0x44868[_0x5ab85f(0x212)]===_0x4d7802)&&(this[_0x5ab85f(0x205)][_0x5ab85f(0x245)](_0x4d7802),!this['init']&&(this[_0x5ab85f(0x1fa)][_0x5ab85f(0x201)]({'ticker':_0x4d7802,'code':_0x57bc6e}),this['sendMessageOnHalts']('NASDAQ',_0x1e492f[_0x5ab85f(0x1f5)],_0x4d7802))));});}};ShareHalts=__decorate([(0x0,common_1[_0x7da7e1(0x202)])(),__metadata(_0x7da7e1(0x22f),[])],ShareHalts),exports['ShareHalts']=ShareHalts;